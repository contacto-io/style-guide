import{r as T,R as a}from"./index-Dl6G-zuu.js";import{P as y}from"./index-Beu9b4Vr.js";import{C as P}from"./index-DsYA414E.js";import{S as O}from"./index-DzmLEK9w.js";import{B as g,T as N}from"./index-DiD84cwB.js";import{I as k}from"./index-ygQga8nQ.js";import{u as W}from"./chunk-2WNKQWTL-DaoWLbBh.js";import"./index-sq4W5l-3.js";import"./index-CTNOGpui.js";import"./toString-Dq7YSAyh.js";import"./assertThisInitialized-BIGTeGEP.js";import"./index-B_8YWI8i.js";import"./index-CUcwQe7c.js";import"./index-B2BRC2NR.js";import"./toArray-Rh0cCEsr.js";import"./context-CRoYx0oq.js";import"./toConsumableArray-RzYAKPeW.js";import"./index-hQ8JTvWt.js";import"./index-C7MRSMQ4.js";import"./index-D89ItNC4.js";import"./index-mFXttzbh.js";import"./type-DdM_TOSm.js";import"./motion-DniBM00U.js";import"./reactNode-CXkgB_jW.js";import"./wave-BLLeykX_.js";import"./createSuper-fkzydAXn.js";import"./index-CvR2ggBW.js";import"./index-DmsR0A_P.js";import"./jsx-runtime-Du8NFWEI.js";import"./button-CgtVjqb1.js";import"./Compact-DE9VlD5A.js";import"./getScrollBarSize-BBtCeGc7.js";import"./statusUtils-DN1vxHNy.js";import"./pickAttrs-D-l_2OcV.js";import"./styleChecker-D06dXjTH.js";import"./index-B11ci13A.js";import"./iconUtil-XvgpoNC6.js";import"./CheckOutlined-tf6StMXB.js";const D=280,F=({item:e,updateNodeType:o})=>{const n=e.data_type==="list"||e.data_type==="static list"||e.data_type==="object";return a.createElement(O,{value:e.data_type,onChange:l=>o(e,l)},a.createElement("option",{value:"string",disabled:n},"String"),a.createElement("option",{value:"number",disabled:n},"Number"),a.createElement("option",{value:"boolean",disabled:n},"Boolean"),a.createElement("option",{value:"object",disabled:!0},"Object"),a.createElement("option",{value:"list",disabled:!n},"List"),a.createElement("option",{value:"static list",disabled:!n},"Static List"),a.createElement("option",{value:"list of strings",disabled:n},"List of Strings"),a.createElement("option",{value:"list of booleans",disabled:n},"List of Booleans"),a.createElement("option",{value:"list of numbers",disabled:n},"List of Numbers"))};function z({item:e,siblings:o,idx:n,updateSelection:l,updateNodeType:t,updateNode:i,options:d,onNodeTypeChange:b,onRelatedValueChange:r}){var h,j,x,S,C,I;const s=T.useMemo(()=>{var m;return(m=e.sub_object)==null?void 0:m.filter(v=>v.selected).length},[e]),p=s>0&&s<e.sub_object.length,f=T.useMemo(()=>d.reduce((m,v)=>{var w,A,J;return((A=(w=v.options)==null?void 0:w[0])==null?void 0:A.api)===((J=e.transformation)==null?void 0:J.api)&&m.push(...v.options.filter(K=>{var L,$,B;return((L=e==null?void 0:e.transformation)==null?void 0:L.path)===""||((B=K.value)==null?void 0:B.startsWith((($=e==null?void 0:e.transformation)==null?void 0:$.path)+"."))})),m},[]),[d,(h=e.transformation)==null?void 0:h.api,(j=e.transformation)==null?void 0:j.path]);return a.createElement(a.Fragment,null,a.createElement(g,{display:"flex",alignItems:"center",gap:16,style:{width:"100%"},className:`${e.transformation?"has-related-value":""}`},a.createElement("div",{className:"checkbox",style:{transform:`translateX(-${32*e.level}px)`}},a.createElement(P,{type:"checkbox",indeterminate:p,checked:e.selected,onChange:m=>l(o==null?void 0:o[n],m.target.checked)})),a.createElement("div",{className:"key",style:{width:`${D-32*e.level}px`}},a.createElement(N,{type:"headline",ellipsis:!0},e.key),((S=(x=e.parent)==null?void 0:x.parent)==null?void 0:S.data_type)==="static list"&&!!e.response_value&&a.createElement(N,{type:"caption",variant:"secondary",ellipsis:!0},e.response_value)),a.createElement(g,{display:"flex",gap:16,className:"select-boxes"},a.createElement(F,{item:e,updateNodeType:(...m)=>{b==null||b(...m),t(...m)}}),e.transformation?a.createElement(a.Fragment,null,a.createElement(O,{options:d,placeholder:"Select",value:`${e.transformation.path?`${e.transformation.path}.${e.transformation.search_key}`:e.transformation.search_key}`,onChange:(m,v)=>{i(e,{transformation:{...e.transformation,related_value:null,api:v.api,path:m.split(".").slice(0,-1).join("."),search_key:m.split(".").slice(-1).join()}})}}),a.createElement(O,{placeholder:"Select",options:f,disabled:e.transformation.path===null||e.transformation.path===void 0,value:(C=e.transformation.related_value)==null?void 0:C.key,onChange:(m,v)=>{i(e,{related_value:r(v,e),transformation:{...e.transformation,related_value:{key:m,data_type:v.data_type,selected:e.selected,transformation:null,sub_object:null}}})}}),a.createElement(k,{name:"playlist_remove",size:20,color:"gray-1",hoverColor:"danger-color",onClick:()=>i(e,{transformation:null,related_value:null})})):a.createElement(a.Fragment,null,a.createElement("div",{className:"add-related-info",onClick:()=>i(e,{transformation:{api:null,path:null,search_key:null,related_value:null}})},e.data_type!=="object"&&e.data_type!=="list"&&e.data_type!=="static list"&&a.createElement(k,{name:"add_circle_outline",size:20,color:"gray-1",style:{flexShrink:0}})),a.createElement("div",null),a.createElement("span",{style:{width:20}})))),e.transformation&&((I=e.transformation.related_value)==null?void 0:I.key)&&a.createElement(g,{className:"item related-value",style:{width:"100%"}},a.createElement(g,{display:"flex",alignItems:"center",gap:16,style:{width:"100%"}},a.createElement("div",{className:"checkbox",style:{transform:`translateX(-${32*e.level}px)`}},a.createElement(P,{type:"checkbox",checked:e.transformation.related_value.selected,onChange:m=>l(e.transformation.related_value,m.target.checked)})),a.createElement("div",{className:"key",style:{width:`${D-32*e.level}px`}},a.createElement(g,{display:"flex",gap:4},a.createElement(N,{type:"headline",ellipsis:!0,style:{width:"auto"}},e.transformation.related_value.key),a.createElement(k,{size:20,name:"link",style:{transform:"rotate(90deg)"},color:"secondary-color"}))),a.createElement(g,{display:"flex",gap:16,className:"select-boxes"},a.createElement(F,{item:e.transformation.related_value,updateNodeType:t}),a.createElement("div",null),a.createElement("div",null),a.createElement("span",{style:{width:20}})))))}z.__docgenInfo={description:"",methods:[],displayName:"ItemRow"};var u;(function(e){e.string="string",e.number="number",e.boolean="boolean",e.list="list",e.object="object",e.staticList="static list",e.listOfStrings="list of strings",e.listOfNumbers="list of numbers",e.listOfBooleans="list of booleans"})(u=u||{});const X={string:"",number:0,boolean:!0,list:[],listOfStrings:[""],listOfNumbers:[0],listOfBooleans:[!0],object:{},"list of strings":[""],"list of numbers":[0],"list of booleans":[!0]};class c{static convertJSONtoTree(o,n,l="",t=0,i=0){return Object.keys(o).map((d,b)=>{const r=o[d],s=c.getType(r),p=Array.isArray(r),f=s===u.object||s===u.list,h=(l?l+".":"")+d;var j=p&&!c.isAllPrimitive(r);const x=s===u.object||j?"":r;return{setSubObject:function(){return this.sub_object=f?c.convertJSONtoTree(p?c.getObjectFromList(r):r,this,h,t+1,b):[],this},key:d,response_key:h,parent:n,parentIndex:i,level:t,response_value:x,selected:!1,data_type:s,sub_object:[]}.setSubObject()})}static generateNewNode(o){return{key:"",response_value:"",data_type:"string",sub_object:[],path:`${o!=null&&o.path?`${o==null?void 0:o.path}.`:""}key`,level:(o==null?void 0:o.level)===void 0?0:(o==null?void 0:o.level)+1,parent:o}}static isAllPrimitive(o){return o.every(n=>typeof n!==u.object)}static getPrimitiveArrayType(o){return o.length?typeof o[0]=="boolean"?u.listOfBooleans:typeof o[0]=="string"?u.listOfStrings:typeof o[0]=="number"?u.listOfNumbers:void 0:u.list}static getType(o){return o==null?"string":Array.isArray(o)?c.isAllPrimitive(o)?this.getPrimitiveArrayType(o):u.list:typeof o===u.object?u.object:typeof o}static getObjectFromList(o){return o.reduce((n,l)=>(c.getType(l)===u.object&&Object.keys(l).forEach(t=>{n[t]||(n[t]=l[t])}),n),{})}}function H({item:e,siblings:o,idx:n,updateSelection:l,addSubItem:t,updateNodeType:i,removeNode:d,updateKey:b}){return a.createElement(a.Fragment,null,a.createElement("div",{className:"checkbox",style:{transform:`translateX(-${32*e.level}px)`}},a.createElement("input",{type:"checkbox",checked:e.selected,onChange:r=>l(o==null?void 0:o[n],r.target.checked)})),a.createElement("div",{className:"add",onClick:()=>t(o,n)},"+"),a.createElement("div",{className:"key"},a.createElement("input",{value:e.key,onChange:r=>b(e,r.target.value)})),a.createElement("div",{className:"type"},a.createElement("select",{value:e.data_type,style:{width:180},onChange:r=>{i(e,r.target.value)}},a.createElement("option",{value:"list"},"Array"),a.createElement("option",{value:"list of strings"},"Array of Strings"),a.createElement("option",{value:"list of numbers"},"Array of Numbers"),a.createElement("option",{value:"list of booleans"},"Array of Booleans"),a.createElement("option",{value:"static list"},"Static List"),a.createElement("option",{value:"string"},"String"),a.createElement("option",{value:"object"},"Object"),a.createElement("option",{value:"number"},"Number"),a.createElement("option",{value:"boolean"},"Boolean"))),a.createElement("div",{className:"remove",onClick:()=>{d(o,n)}},"âž–"))}function Y(e,t){var n,l,t=(t=t===void 0?{}:t).insertAt;e&&typeof document<"u"&&(n=document.head||document.getElementsByTagName("head")[0],(l=document.createElement("style")).type="text/css",t==="top"&&n.firstChild?n.insertBefore(l,n.firstChild):n.appendChild(l),l.styleSheet?l.styleSheet.cssText=e:l.appendChild(document.createTextNode(e)))}c.convertTreetoJSON=e=>e.reduce((o,n)=>{var l,t=(t=n.key)!=null?t:(t=n.response_key.match(/\w+$/g))==null?void 0:t[0];if(o[t]=n.response_value||X[n.data_type],(l=n==null?void 0:n.sub_object)!=null&&l.length){let i;i=n.data_type===u.list||n.data_type===u.staticList?((l=n.meta)==null?void 0:l.original_value)||[c.convertTreetoJSON(n.sub_object)]:c.convertTreetoJSON(n.sub_object),o[t]=i}return o},{}),c.transformTree=(e,o,n=0,l=0)=>e.map((t,i)=>{var d;return t.parent=o,t.level=n,t.parentIndex=l,t.related_value&&(t.related_value.parent=t),(d=t.transformed_sub_object)!=null&&d.length&&(t.transformed_sub_object=c.transformTree(t.transformed_sub_object,t,n,i)),(d=t.sub_object)!=null&&d.length&&(t.sub_object=c.transformTree(t.sub_object,t,n+1,i)),t}),c.cleanTree=(e,o=!0,n=!1,l=!0)=>e.map(t=>{var i;return t.parent=t.path=t.level=t.parentIndex=t.setSubObject=void 0,o&&(t.response_key=void 0),n&&(t.selected=void 0,t.value=t==null?void 0:t.response_value),l&&(t.response_value=void 0),t.related_value&&(t.related_value.parent=void 0),(i=t.transformed_sub_object)!=null&&i.length&&(t.transformed_sub_object=c.cleanTree(t.transformed_sub_object,o,n,l)),(i=t.sub_object)!=null&&i.length&&(t.sub_object=c.cleanTree(t.sub_object,o,n,l)),t});var G=`.schema-editor.default input, .schema-editor.default select {
  height: 24px;
  margin: 0;
  font-size: 16px;
  padding: 0 4px;
}
.schema-editor.default .add {
  border: 1px solid;
  width: 24px;
  height: 24px;
  display: grid;
  place-items: center;
}
.schema-editor.default .remove, .schema-editor.default .add {
  cursor: pointer;
}
.schema-editor .object {
  flex-basis: 100%;
}
.schema-editor .object .object {
  margin-left: 32px;
}
.schema-editor .object .object .item::before {
  content: "";
  position: absolute;
  display: block;
  height: calc(100% + 24px);
  top: 0px;
  left: 8px;
  width: 1px;
  background-color: #000;
}
.schema-editor .object .object .item:after {
  position: absolute;
  display: block;
  content: "";
  width: 16px;
  height: 1px;
  background-color: #000;
  top: 16px;
  left: 8px;
}
.schema-editor .object .object .item:last-child:before {
  height: 16px;
}
.schema-editor .object .item {
  margin-top: 24px;
  position: relative;
  display: flex;
  column-gap: 16px;
  align-items: center;
  flex-wrap: wrap;
}`;Y(G);const M=({data:e,ItemComponent:o,treeMethods:n})=>a.createElement("div",{className:"object"},e.map((l,t)=>{var i=Object.assign({siblings:e,item:l,idx:t},n);return a.createElement("div",{key:t,className:`item ${(t=l.sub_object)!=null&&t.length?"has-children":""} `+(((t=l.parent)==null?void 0:t.data_type)===u.staticList?"static-list-item":"")},a.createElement(o||H,Object.assign({},i)),!((t=l.sub_object)==null||!t.length)&&a.createElement(M,{data:l.sub_object,ItemComponent:o,treeMethods:n}))})),Q=(e,o)=>{const n=T.useCallback(r=>(...s)=>r(...s)||o(e),[]),l=(r,s)=>{r!=null&&r.push(c.generateNewNode(s))},t=(r,s)=>{r!=null&&r.sub_object.forEach(p=>{var f;p.selected=s,(f=p==null?void 0:p.sub_object)!=null&&f.length&&d(p,s)})},i=(r,s)=>{var p;r!=null&&r.parent&&((p=r.parent)!=null&&p.parent&&i(r==null?void 0:r.parent,s),r.parent.selected=s)},d=(r,s,p=!1)=>{var f;r&&(r.selected=s),(f=r==null?void 0:r.sub_object)!=null&&f.length&&!p&&t(r,s),s?i(r,!0):r&&r.parent&&!r.parent.sub_object.some(h=>h.selected)&&d(r.parent,!1,!0)},b=(r,s)=>{Object.assign(r,s)};return{updateSelection:n(d),updateNodeType:n((r,s)=>{(r.data_type=s)===u.object&&(r.sub_object=[c.generateNewNode(r)])}),removeNode:n((r,s)=>{r!=null&&r.splice(s,1)}),addSubItem:n((r,s)=>{var p;r&&(r[s].data_type!==u.list&&(r[s].data_type=u.object),r[s].response_value="",p=r[s].sub_object,l(p,r[s]))}),addItem:n(l),updateKey:n((r,s)=>{b(r,{key:s})}),updateValue:n((r,s)=>{b(r,{response_value:s})}),selectAll:n(r=>{e.forEach(s=>{var p;s.selected=r,(p=s==null?void 0:s.sub_object)!=null&&p.length&&t(s,r)})}),updateNode:n(b)}},Z=({data:e,ItemComponent:o,fromTree:n,onChange:l})=>(n?c.transformTree(e,void 0):c.convertJSONtoTree(e,void 0),n=Q(e,l),a.createElement("div",{className:"schema-editor "+(o?"custom":"default")},a.createElement(M,{data:e,ItemComponent:o,treeMethods:n}))),E=({className:e="",data:o,mode:n="schema",fromTree:l,onNodeTypeChange:t,onRelatedValueChange:i,options:d,...b})=>{const r=s=>a.createElement(z,{...s,options:d,onNodeTypeChange:t,onRelatedValueChange:i});return a.createElement("div",{className:["sg contacto-jsoneditor",e,n].join(" ")},a.createElement(Z,{data:o,ItemComponent:r,fromTree:l,...b}))};E.propTypes={className:y.string,data:y.any,mode:y.string,fromTree:y.bool,options:y.array,onNodeTypeChange:y.func,onRelatedValueChange:y.func};E.defaultProps={};E.__docgenInfo={description:"A JSON Editor component wrapped upon rc-json-editor",methods:[],displayName:"JSONEditor",props:{className:{defaultValue:{value:"''",computed:!1},description:"Class to be added",type:{name:"string"},required:!1},mode:{defaultValue:{value:"'schema'",computed:!1},description:"Type of JSON Editor - schema, key-value, no-children",type:{name:"string"},required:!1},data:{description:"JSON data that has to loaded - can be tree data or JSON data",type:{name:"any"},required:!1},fromTree:{description:"Whether the data is JSON or Tree data",type:{name:"bool"},required:!1},options:{description:"",type:{name:"array"},required:!1},onNodeTypeChange:{description:"",type:{name:"func"},required:!1},onRelatedValueChange:{description:"",type:{name:"func"},required:!1}}};const Fe={title:"Components/JSONEditor",component:E},U={fromTree:!0,options:[{label:"API 1",options:[{value:"123"}]}],data:c.cleanTree(c.convertJSONtoTree({a:[{id:1},{id:2}],b:"",c:""}))},ee=e=>{const[{data:o},n]=W();return a.createElement("div",null,a.createElement(E,{fromTree:!0,...e,onChange:l=>{console.log("onChange",l),n({data:c.cleanTree(l,!1,void 0,!1)})}}))},_=ee.bind({});_.args=U;var q,R,V;_.parameters={..._.parameters,docs:{...(q=_.parameters)==null?void 0:q.docs,source:{originalSource:`args => {
  const [{
    data
  }, updateArgs] = useArgs();
  return <div>
      <JSONEditor fromTree {...args} onChange={data => {
      console.log('onChange', data);
      updateArgs({
        data: TreeUtils.cleanTree(data, false, undefined, false)
      });
    }} />
    </div>;
}`,...(V=(R=_.parameters)==null?void 0:R.docs)==null?void 0:V.source}}};const qe=["LoadingFromTreeData"];export{_ as LoadingFromTreeData,qe as __namedExportsOrder,Fe as default};
